{
  "scopeName": "source.mmbasic",
  "name": "MMBasic",
  "fileTypes": [
    "bas",
    "mmb"
  ],
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#numbers"
    },
    {
      "include": "#keywords"
    },
    {
      "include": "#functions"
    },
    {
      "include": "#hardware-commands"
    },
    {
      "include": "#graphics-commands"
    },
    {
      "include": "#operators"
    },
    {
      "include": "#variables"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.apostrophe.mmbasic",
          "match": "'.*$"
        },
        {
          "name": "comment.line.rem.mmbasic",
          "match": "(?i)\\bREM\\b.*$"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.mmbasic",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.mmbasic",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.hex.mmbasic",
          "match": "(?i)&H[0-9A-F]+"
        },
        {
          "name": "constant.numeric.binary.mmbasic",
          "match": "(?i)&B[01]+"
        },
        {
          "name": "constant.numeric.octal.mmbasic",
          "match": "(?i)&O[0-7]+"
        },
        {
          "name": "constant.numeric.float.mmbasic",
          "match": "\\b[0-9]+\\.[0-9]+([Ee][+-]?[0-9]+)?\\b"
        },
        {
          "name": "constant.numeric.integer.mmbasic",
          "match": "\\b[0-9]+\\b"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.mmbasic",
          "match": "(?i)\\b(IF|THEN|ELSE|ELSEIF|END IF|ENDIF|FOR|TO|STEP|NEXT|DO|LOOP|WHILE|WEND|UNTIL|SELECT CASE|CASE|IS|END SELECT|GOTO|GOSUB|RETURN|EXIT|CONTINUE|ON ERROR|ERROR|SKIP)\\b"
        },
        {
          "name": "keyword.other.mmbasic",
          "match": "(?i)\\b(SUB|END SUB|FUNCTION|END FUNCTION|DIM|LOCAL|STATIC|CONST|DATA|READ|RESTORE|ERASE|OPTION|AUTOSAVE|AUTORUN|BASE|BREAK|EXPLICIT|DEFAULT|ESCAPE|RUN|NEW|EDIT|LIST|CLEAR|MEMORY|FILES|LOAD|SAVE|CHAIN|KILL|MKDIR|RMDIR|CHDIR|COPY|RENAME|LIBRARY|END|TROFF|TRON|VAR)\\b"
        },
        {
          "name": "keyword.operator.logical.mmbasic",
          "match": "(?i)\\b(AND|OR|NOT|XOR|MOD|INV)\\b"
        },
        {
          "name": "storage.type.mmbasic",
          "match": "(?i)\\b(INTEGER|FLOAT|STRING|AS|LENGTH)\\b"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "support.function.builtin.mmbasic",
          "match": "(?i)\\b(ABS|ASC|ATN|BIN\\$|CALL|CHR\\$|CHOICE|CINT|COS|DATE\\$|DATETIME\\$|DAY|DEVICE|DIR\\$|DISTANCE|EPOCH|EOF|ERRMSG\\$|ERRNO|EXP|FIELD\\$|FIX|FORMAT\\$|HEX\\$|INKEY\\$|INPUT\\$|INSTR|INT|JSON\\$|LCASE\\$|LEFT\\$|LEN|LGETBYTE|LGETSTR\\$|LINSTR|LOG|LCOMPARE|LLEN|MID\\$|MMINFO|MMCMDLINE\\$|MMPROGNAME\\$|OCT\\$|PEEK|PI|PIXEL|RANDOM|RGB|RIGHT\\$|RND|SGN|SIN|SPACE\\$|SQR|STR\\$|STRING\\$|TAB|TAN|UCASE\\$|VAL|VERSION)\\b"
        },
        {
          "name": "support.function.io.mmbasic",
          "match": "(?i)\\b(OPEN|CLOSE|PRINT|INPUT|LINE INPUT|WRITE|SEEK|LOC|LOF|EOF)\\b"
        },
        {
          "name": "support.function.time.mmbasic", 
          "match": "(?i)\\b(TIME\\$|TIMER|DATE\\$|DATETIME\\$|EPOCH)\\b"
        }
      ]
    },
    "hardware-commands": {
      "patterns": [
        {
          "name": "support.function.hardware.mmbasic",
          "match": "(?i)\\b(SETPIN|PIN|PULSIN|PULSE|PWM|SERVO|ADC|DAC|I2C|I2C2|SPI|SPI2|SERIAL|COM1|COM2|SETTICK|PAUSE|CPU|MEMORY|PORT|INTERRUPT|IR|RTC|TEMPR|HUMID|KEYPAD|DISTANCE|WS2812|DHT22|DS18B20|ONEWIRE|PS2|USB|INFRARED|GPS|WATCHDOG|BACKLIGHT|FRAMEBUFFER|GAMEPAD)\\b"
        }
      ]
    },
    "graphics-commands": {
      "patterns": [
        {
          "name": "support.function.graphics.mmbasic",
          "match": "(?i)\\b(CLS|COLOUR|COLOR|PIXEL|LINE|BOX|RBOX|CIRCLE|ARC|TRIANGLE|TEXT|PRINT|FONT|PAGE|BLIT|SPRITE|LOAD IMAGE|SAVE IMAGE|MODE|GUI|HIDE|SHOW|DRAW|POLYGON|TILE|FRAMEBUFFER|LAYER|BITMAP|IMAGE|REFRESH)\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.arithmetic.mmbasic",
          "match": "\\+|\\-|\\*|\\/|\\\\|\\^"
        },
        {
          "name": "keyword.operator.comparison.mmbasic",
          "match": "=|<>|<|>|<=|>="
        },
        {
          "name": "keyword.operator.assignment.mmbasic",
          "match": "="
        }
      ]
    },
    "variables": {
      "patterns": [
        {
          "name": "variable.other.string.mmbasic",
          "match": "\\b[A-Za-z_][A-Za-z0-9_]*\\$"
        },
        {
          "name": "variable.other.integer.mmbasic",
          "match": "\\b[A-Za-z_][A-Za-z0-9_]*%"
        },
        {
          "name": "variable.other.mmbasic",
          "match": "\\b[A-Za-z_][A-Za-z0-9_]*\\b"
        }
      ]
    }
  }
}
